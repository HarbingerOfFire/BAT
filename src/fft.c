/*
 * FFT code.
 */

#include "inner.h"

/*
 * Rules for complex number macros:
 * --------------------------------
 *
 * Operand order is: destination, source1, source2...
 *
 * Each operand is a real and an imaginary part.
 *
 * All overlaps are allowed.
 */

/*
 * Addition of two complex numbers (d = a + b).
 */
#define FNC_ADD(d_re, d_im, a_re, a_im, b_re, b_im)   do { \
		fnr fnct_re, fnct_im; \
		fnct_re = fnr_add(a_re, b_re); \
		fnct_im = fnr_add(a_im, b_im); \
		(d_re) = fnct_re; \
		(d_im) = fnct_im; \
	} while (0)

/*
 * Subtraction of two complex numbers (d = a - b).
 */
#define FNC_SUB(d_re, d_im, a_re, a_im, b_re, b_im)   do { \
		fnr fnct_re, fnct_im; \
		fnct_re = fnr_sub(a_re, b_re); \
		fnct_im = fnr_sub(a_im, b_im); \
		(d_re) = fnct_re; \
		(d_im) = fnct_im; \
	} while (0)

/*
 * Multplication of two complex numbers (d = a * b).
 */
#define FNC_MUL(d_re, d_im, a_re, a_im, b_re, b_im)   do { \
		fnr fnct_a_re, fnct_a_im; \
		fnr fnct_b_re, fnct_b_im; \
		fnr fnct_d_re, fnct_d_im; \
		fnct_a_re = (a_re); \
		fnct_a_im = (a_im); \
		fnct_b_re = (b_re); \
		fnct_b_im = (b_im); \
		fnct_d_re = fnr_sub( \
			fnr_mul(fnct_a_re, fnct_b_re), \
			fnr_mul(fnct_a_im, fnct_b_im)); \
		fnct_d_im = fnr_add( \
			fnr_mul(fnct_a_re, fnct_b_im), \
			fnr_mul(fnct_a_im, fnct_b_re)); \
		(d_re) = fnct_d_re; \
		(d_im) = fnct_d_im; \
	} while (0)

/*
 * Squaring of a complex number (d = a * a).
 */
#define FNC_SQR(d_re, d_im, a_re, a_im)   do { \
		fnr fnct_a_re, fnct_a_im; \
		fnr fnct_d_re, fnct_d_im; \
		fnct_a_re = (a_re); \
		fnct_a_im = (a_im); \
		fnct_d_re = fnr_sub(fnr_sqr(fnct_a_re), fnr_sqr(fnct_a_im)); \
		fnct_d_im = fnr_double(fnr_mul(fnct_a_re, fnct_a_im)); \
		(d_re) = fnct_d_re; \
		(d_im) = fnct_d_im; \
	} while (0)

/*
 * Division of complex numbers (d = a / b).
 */
#define FNR_DIV(d_re, d_im, a_re, a_im, b_re, b_im)   do { \
		fnr fnct_a_re, fnct_a_im; \
		fnr fnct_b_re, fnct_b_im; \
		fnr fnct_d_re, fnct_d_im; \
		fnr fnct_m; \
		fnct_a_re = (a_re); \
		fnct_a_im = (a_im); \
		fnct_b_re = (b_re); \
		fnct_b_im = (b_im); \
		fnct_m = fnr_add(fnr_sqr(fnct_b_re), fnr_sqr(fnct_b_im)); \
		fnct_m = fnr_inv(fnct_m); \
		fnct_b_re = fnr_mul(fnct_b_re, fnct_m); \
		fnct_b_im = fnr_mul(fnr_neg(fnct_b_im), fnct_m); \
		fnct_d_re = fnr_sub( \
			fnr_mul(fnct_a_re, fnct_b_re), \
			fnr_mul(fnct_a_im, fnct_b_im)); \
		fnct_d_im = fnr_add( \
			fnr_mul(fnct_a_re, fnct_b_im), \
			fnr_mul(fnct_a_im, fnct_b_re)); \
		(d_re) = fnct_d_re; \
		(d_im) = fnct_d_im; \
	} while (0)

/*
 * n = 2^1024
 * w = exp(i*pi/n) (a primitive 2n-th root of 1)
 * w_j = w^(2j+1) for j = 0..n-1 (n-th roots of -1)
 * rev() = bit reversal over 10 bits
 * Re(w_j), Im(w_j) go to slots 2*rev(j), 2*rev(j)+1
 */
static const fnr fnr_gm_tab[] = {
	{           4294967296u }, {                    0u },
	{                    0u }, {           4294967296u },
	{           3037000500u }, {           3037000500u },
	{ 18446744070672551116u }, {           3037000500u },
	{           3968032378u }, {           1643612827u },
	{ 18446744072065938789u }, {           3968032378u },
	{           1643612827u }, {           3968032378u },
	{ 18446744069741519238u }, {           1643612827u },
	{           4212440704u }, {            837906553u },
	{ 18446744072871645063u }, {           4212440704u },
	{           2386155981u }, {           3571134792u },
	{ 18446744070138416824u }, {           2386155981u },
	{           3571134792u }, {           2386155981u },
	{ 18446744071323395635u }, {           3571134792u },
	{            837906553u }, {           4212440704u },
	{ 18446744069497110912u }, {            837906553u },
	{           4274285855u }, {            420980412u },
	{ 18446744073288571204u }, {           4274285855u },
	{           2724698408u }, {           3320054617u },
	{ 18446744070389496999u }, {           2724698408u },
	{           3787822988u }, {           2024633568u },
	{ 18446744071684918048u }, {           3787822988u },
	{           1246763195u }, {           4110027446u },
	{ 18446744069599524170u }, {           1246763195u },
	{           4110027446u }, {           1246763195u },
	{ 18446744072462788421u }, {           4110027446u },
	{           2024633568u }, {           3787822988u },
	{ 18446744069921728628u }, {           2024633568u },
	{           3320054617u }, {           2724698408u },
	{ 18446744070984853208u }, {           3320054617u },
	{            420980412u }, {           4274285855u },
	{ 18446744069435265761u }, {            420980412u },
	{           4289793820u }, {            210744057u },
	{ 18446744073498807559u }, {           4289793820u },
	{           2884323748u }, {           3182360851u },
	{ 18446744070527190765u }, {           2884323748u },
	{           3882604450u }, {           1836335144u },
	{ 18446744071873216472u }, {           3882604450u },
	{           1446930903u }, {           4043900968u },
	{ 18446744069665650648u }, {           1446930903u },
	{           4166252509u }, {           1043591926u },
	{ 18446744072665959690u }, {           4166252509u },
	{           2208054473u }, {           3683916329u },
	{ 18446744070025635287u }, {           2208054473u },
	{           3449750080u }, {           2558509031u },
	{ 18446744071151042585u }, {           3449750080u },
	{            630202589u }, {           4248480760u },
	{ 18446744069461070856u }, {            630202589u },
	{           4248480760u }, {            630202589u },
	{ 18446744073079349027u }, {           4248480760u },
	{           2558509031u }, {           3449750080u },
	{ 18446744070259801536u }, {           2558509031u },
	{           3683916329u }, {           2208054473u },
	{ 18446744071501497143u }, {           3683916329u },
	{           1043591926u }, {           4166252509u },
	{ 18446744069543299107u }, {           1043591926u },
	{           4043900968u }, {           1446930903u },
	{ 18446744072262620713u }, {           4043900968u },
	{           1836335144u }, {           3882604450u },
	{ 18446744069826947166u }, {           1836335144u },
	{           3182360851u }, {           2884323748u },
	{ 18446744070825227868u }, {           3182360851u },
	{            210744057u }, {           4289793820u },
	{ 18446744069419757796u }, {            210744057u },
	{           4293673732u }, {            105403774u },
	{ 18446744073604147842u }, {           4293673732u },
	{           2961554089u }, {           3110617535u },
	{ 18446744070598934081u }, {           2961554089u },
	{           3926501002u }, {           1740498191u },
	{ 18446744071969053425u }, {           3926501002u },
	{           1545737412u }, {           4007173558u },
	{ 18446744069702378058u }, {           1545737412u },
	{           4190608739u }, {            941032661u },
	{ 18446744072768518955u }, {           4190608739u },
	{           2297797281u }, {           3628618433u },
	{ 18446744070080933183u }, {           2297797281u },
	{           3511500034u }, {           2473077351u },
	{ 18446744071236474265u }, {           3511500034u },
	{            734275721u }, {           4231735252u },
	{ 18446744069477816364u }, {            734275721u },
	{           4262667143u }, {            525749847u },
	{ 18446744073183801769u }, {           4262667143u },
	{           2642399561u }, {           3385922125u },
	{ 18446744070323629491u }, {           2642399561u },
	{           3736995171u }, {           2116981616u },
	{ 18446744071592570000u }, {           3736995171u },
	{           1145522571u }, {           4139386683u },
	{ 18446744069570164933u }, {           1145522571u },
	{           4078192482u }, {           1347252816u },
	{ 18446744072362298800u }, {           4078192482u },
	{           1931065957u }, {           3836369162u },
	{ 18446744069873182454u }, {           1931065957u },
	{           3252187232u }, {           2805355999u },
	{ 18446744070904195617u }, {           3252187232u },
	{            315957395u }, {           4283329896u },
	{ 18446744069426221720u }, {            315957395u },
	{           4283329896u }, {            315957395u },
	{ 18446744073393594221u }, {           4283329896u },
	{           2805355999u }, {           3252187232u },
	{ 18446744070457364384u }, {           2805355999u },
	{           3836369162u }, {           1931065957u },
	{ 18446744071778485659u }, {           3836369162u },
	{           1347252816u }, {           4078192482u },
	{ 18446744069631359134u }, {           1347252816u },
	{           4139386683u }, {           1145522571u },
	{ 18446744072564029045u }, {           4139386683u },
	{           2116981616u }, {           3736995171u },
	{ 18446744069972556445u }, {           2116981616u },
	{           3385922125u }, {           2642399561u },
	{ 18446744071067152055u }, {           3385922125u },
	{            525749847u }, {           4262667143u },
	{ 18446744069446884473u }, {            525749847u },
	{           4231735252u }, {            734275721u },
	{ 18446744072975275895u }, {           4231735252u },
	{           2473077351u }, {           3511500034u },
	{ 18446744070198051582u }, {           2473077351u },
	{           3628618433u }, {           2297797281u },
	{ 18446744071411754335u }, {           3628618433u },
	{            941032661u }, {           4190608739u },
	{ 18446744069518942877u }, {            941032661u },
	{           4007173558u }, {           1545737412u },
	{ 18446744072163814204u }, {           4007173558u },
	{           1740498191u }, {           3926501002u },
	{ 18446744069783050614u }, {           1740498191u },
	{           3110617535u }, {           2961554089u },
	{ 18446744070747997527u }, {           3110617535u },
	{            105403774u }, {           4293673732u },
	{ 18446744069415877884u }, {            105403774u },
	{           4294643893u }, {             52705856u },
	{ 18446744073656845760u }, {           4294643893u },
	{           2999503152u }, {           3074040487u },
	{ 18446744070635511129u }, {           2999503152u },
	{           3947563934u }, {           1692182927u },
	{ 18446744072017368689u }, {           3947563934u },
	{           1594795204u }, {           3987903250u },
	{ 18446744069721648366u }, {           1594795204u },
	{           4201841112u }, {            889536587u },
	{ 18446744072820015029u }, {           4201841112u },
	{           2342152991u }, {           3600147697u },
	{ 18446744070109403919u }, {           2342152991u },
	{           3541584088u }, {           2429799626u },
	{ 18446744071279751990u }, {           3541584088u },
	{            786150333u }, {           4222405917u },
	{ 18446744069487145699u }, {            786150333u },
	{           4268797931u }, {            473400776u },
	{ 18446744073236150840u }, {           4268797931u },
	{           2683751066u }, {           3353240863u },
	{ 18446744070356310753u }, {           2683751066u },
	{           3762692404u }, {           2070963532u },
	{ 18446744071638588084u }, {           3762692404u },
	{           1196232957u }, {           4125017671u },
	{ 18446744069584533945u }, {           1196232957u },
	{           4094418266u }, {           1297105676u },
	{ 18446744072412445940u }, {           4094418266u },
	{           1977998702u }, {           3812383140u },
	{ 18446744069897168476u }, {           1977998702u },
	{           3286368382u }, {           2765235421u },
	{ 18446744070944316195u }, {           3286368382u },
	{            368496651u }, {           4279130086u },
	{ 18446744069430421530u }, {            368496651u },
	{           4286884652u }, {            263370557u },
	{ 18446744073446181059u }, {           4286884652u },
	{           2845054101u }, {           3217516315u },
	{ 18446744070492035301u }, {           2845054101u },
	{           3859777440u }, {           1883842400u },
	{ 18446744071825709216u }, {           3859777440u },
	{           1397197066u }, {           4061352537u },
	{ 18446744069648199079u }, {           1397197066u },
	{           4153132319u }, {           1094639673u },
	{ 18446744072614911943u }, {           4153132319u },
	{           2162680890u }, {           3710735162u },
	{ 18446744069998816454u }, {           2162680890u },
	{           3418093478u }, {           2600650120u },
	{ 18446744071108901496u }, {           3418093478u },
	{            578019742u }, {           4255894413u },
	{ 18446744069453657203u }, {            578019742u },
	{           4240427302u }, {            682290530u },
	{ 18446744073027261086u }, {           4240427302u },
	{           2515982640u }, {           3480887161u },
	{ 18446744070228664455u }, {           2515982640u },
	{           3656542712u }, {           2253095531u },
	{ 18446744071456456085u }, {           3656542712u },
	{            992387019u }, {           4178745276u },
	{ 18446744069530806340u }, {            992387019u },
	{           4025840401u }, {           1496446837u },
	{ 18446744072213104779u }, {           4025840401u },
	{           1788551342u }, {           3904846754u },
	{ 18446744069804704862u }, {           1788551342u },
	{           3146726136u }, {           2923159027u },
	{ 18446744070786392589u }, {           3146726136u },
	{            158085819u }, {           4292056960u },
	{ 18446744069417494656u }, {            158085819u },
	{           4292056960u }, {            158085819u },
	{ 18446744073551465797u }, {           4292056960u },
	{           2923159027u }, {           3146726136u },
	{ 18446744070562825480u }, {           2923159027u },
	{           3904846754u }, {           1788551342u },
	{ 18446744071921000274u }, {           3904846754u },
	{           1496446837u }, {           4025840401u },
	{ 18446744069683711215u }, {           1496446837u },
	{           4178745276u }, {            992387019u },
	{ 18446744072717164597u }, {           4178745276u },
	{           2253095531u }, {           3656542712u },
	{ 18446744070053008904u }, {           2253095531u },
	{           3480887161u }, {           2515982640u },
	{ 18446744071193568976u }, {           3480887161u },
	{            682290530u }, {           4240427302u },
	{ 18446744069469124314u }, {            682290530u },
	{           4255894413u }, {            578019742u },
	{ 18446744073131531874u }, {           4255894413u },
	{           2600650120u }, {           3418093478u },
	{ 18446744070291458138u }, {           2600650120u },
	{           3710735162u }, {           2162680890u },
	{ 18446744071546870726u }, {           3710735162u },
	{           1094639673u }, {           4153132319u },
	{ 18446744069556419297u }, {           1094639673u },
	{           4061352537u }, {           1397197066u },
	{ 18446744072312354550u }, {           4061352537u },
	{           1883842400u }, {           3859777440u },
	{ 18446744069849774176u }, {           1883842400u },
	{           3217516315u }, {           2845054101u },
	{ 18446744070864497515u }, {           3217516315u },
	{            263370557u }, {           4286884652u },
	{ 18446744069422666964u }, {            263370557u },
	{           4279130086u }, {            368496651u },
	{ 18446744073341054965u }, {           4279130086u },
	{           2765235421u }, {           3286368382u },
	{ 18446744070423183234u }, {           2765235421u },
	{           3812383140u }, {           1977998702u },
	{ 18446744071731552914u }, {           3812383140u },
	{           1297105676u }, {           4094418266u },
	{ 18446744069615133350u }, {           1297105676u },
	{           4125017671u }, {           1196232957u },
	{ 18446744072513318659u }, {           4125017671u },
	{           2070963532u }, {           3762692404u },
	{ 18446744069946859212u }, {           2070963532u },
	{           3353240863u }, {           2683751066u },
	{ 18446744071025800550u }, {           3353240863u },
	{            473400776u }, {           4268797931u },
	{ 18446744069440753685u }, {            473400776u },
	{           4222405917u }, {            786150333u },
	{ 18446744072923401283u }, {           4222405917u },
	{           2429799626u }, {           3541584088u },
	{ 18446744070167967528u }, {           2429799626u },
	{           3600147697u }, {           2342152991u },
	{ 18446744071367398625u }, {           3600147697u },
	{            889536587u }, {           4201841112u },
	{ 18446744069507710504u }, {            889536587u },
	{           3987903250u }, {           1594795204u },
	{ 18446744072114756412u }, {           3987903250u },
	{           1692182927u }, {           3947563934u },
	{ 18446744069761987682u }, {           1692182927u },
	{           3074040487u }, {           2999503152u },
	{ 18446744070710048464u }, {           3074040487u },
	{             52705856u }, {           4294643893u },
	{ 18446744069414907723u }, {             52705856u },
	{           4294886444u }, {             26353424u },
	{ 18446744073683198192u }, {           4294886444u },
	{           3018308645u }, {           3055578014u },
	{ 18446744070653973602u }, {           3018308645u },
	{           3957872662u }, {           1667929275u },
	{ 18446744072041622341u }, {           3957872662u },
	{           1619234497u }, {           3978042699u },
	{ 18446744069731508917u }, {           1619234497u },
	{           4207220108u }, {            863737830u },
	{ 18446744072845813786u }, {           4207220108u },
	{           2364198992u }, {           3585708745u },
	{ 18446744070123842871u }, {           2364198992u },
	{           3556426389u }, {           2408023134u },
	{ 18446744071301528482u }, {           3556426389u },
	{            812043729u }, {           4217502704u },
	{ 18446744069492048912u }, {            812043729u },
	{           4271622305u }, {            447199012u },
	{ 18446744073262352604u }, {           4271622305u },
	{           2704275644u }, {           3336710553u },
	{ 18446744070372841063u }, {           2704275644u },
	{           3775328765u }, {           2047837100u },
	{ 18446744071661714516u }, {           3775328765u },
	{           1221521071u }, {           4117600071u },
	{ 18446744069591951545u }, {           1221521071u },
	{           4102300081u }, {           1271958380u },
	{ 18446744072437593236u }, {           4102300081u },
	{           2001353810u }, {           3800174601u },
	{ 18446744069909377015u }, {           2001353810u },
	{           3303273682u }, {           2745018589u },
	{ 18446744070964533027u }, {           3303273682u },
	{            394745962u }, {           4276788480u },
	{ 18446744069432763136u }, {            394745962u },
	{           4288419964u }, {            237061769u },
	{ 18446744073472489847u }, {           4288419964u },
	{           2864742853u }, {           3199998822u },
	{ 18446744070509552794u }, {           2864742853u },
	{           3871263820u }, {           1860123788u },
	{ 18446744071849427828u }, {           3871263820u },
	{           1422090755u }, {           4052703044u },
	{ 18446744069656848572u }, {           1422090755u },
	{           4159770720u }, {           1069135926u },
	{ 18446744072640415690u }, {           4159770720u },
	{           2185408821u }, {           3697395348u },
	{ 18446744070012156268u }, {           2185408821u },
	{           3433986423u }, {           2579628136u },
	{ 18446744071129923480u }, {           3433986423u },
	{            604122538u }, {           4252267634u },
	{ 18446744069457283982u }, {            604122538u },
	{           4244533933u }, {            656258914u },
	{ 18446744073053292702u }, {           4244533933u },
	{           2537293599u }, {           3465383855u },
	{ 18446744070244167761u }, {           2537293599u },
	{           3670298613u }, {           2230616993u },
	{ 18446744071478934623u }, {           3670298613u },
	{           1018008636u }, {           4172577440u },
	{ 18446744069536974176u }, {           1018008636u },
	{           4034946641u }, {           1471716574u },
	{ 18446744072237835042u }, {           4034946641u },
	{           1812477362u }, {           3893798902u },
	{ 18446744069815752714u }, {           1812477362u },
	{           3164603066u }, {           2903796051u },
	{ 18446744070805755565u }, {           3164603066u },
	{            184418409u }, {           4291006167u },
	{ 18446744069418545449u }, {            184418409u },
	{           4292946160u }, {            131747276u },
	{ 18446744073577804340u }, {           4292946160u },
	{           2942411948u }, {           3128730733u },
	{ 18446744070580820883u }, {           2942411948u },
	{           3915747591u }, {           1764557983u },
	{ 18446744071944993633u }, {           3915747591u },
	{           1521120759u }, {           4016582591u },
	{ 18446744069692969025u }, {           1521120759u },
	{           4184755784u }, {            966728038u },
	{ 18446744072742823578u }, {           4184755784u },
	{           2275489241u }, {           3642649144u },
	{ 18446744070066902472u }, {           2275489241u },
	{           3496259414u }, {           2494576955u },
	{ 18446744071214974661u }, {           3496259414u },
	{            708296459u }, {           4236161021u },
	{ 18446744069473390595u }, {            708296459u },
	{           4259360959u }, {            551895183u },
	{ 18446744073157656433u }, {           4259360959u },
	{           2621574191u }, {           3402071844u },
	{ 18446744070307479772u }, {           2621574191u },
	{           3723935269u }, {           2139871536u },
	{ 18446744071569680080u }, {           3723935269u },
	{           1120102207u }, {           4146337555u },
	{ 18446744069563214061u }, {           1120102207u },
	{           4069849124u }, {           1372250773u },
	{ 18446744072337300843u }, {           4069849124u },
	{           1907490086u }, {           3848145741u },
	{ 18446744069861405875u }, {           1907490086u },
	{           3234912670u }, {           2825258235u },
	{ 18446744070884293381u }, {           3234912670u },
	{            289669429u }, {           4285187942u },
	{ 18446744069424363674u }, {            289669429u },
	{           4281310585u }, {            342233465u },
	{ 18446744073367318151u }, {           4281310585u },
	{           2785348143u }, {           3269339351u },
	{ 18446744070440212265u }, {           2785348143u },
	{           3824448145u }, {           1954569124u },
	{ 18446744071754982492u }, {           3824448145u },
	{           1322204136u }, {           4086382299u },
	{ 18446744069623169317u }, {           1322204136u },
	{           4132279966u }, {           1170899806u },
	{ 18446744072538651810u }, {           4132279966u },
	{           2094011993u }, {           3749914379u },
	{ 18446744069959637237u }, {           2094011993u },
	{           3369644927u }, {           2663125446u },
	{ 18446744071046426170u }, {           3369644927u },
	{            499584716u }, {           4265812840u },
	{ 18446744069443738776u }, {            499584716u },
	{           4227150159u }, {            760227338u },
	{ 18446744072949324278u }, {           4227150159u },
	{           2451484637u }, {           3526608449u },
	{ 18446744070182943167u }, {           2451484637u },
	{           3614451106u }, {           2320018810u },
	{ 18446744071389532806u }, {           3614451106u },
	{            915301854u }, {           4196303920u },
	{ 18446744069513247696u }, {            915301854u },
	{           3997613658u }, {           1570295869u },
	{ 18446744072139255747u }, {           3997613658u },
	{           1716372869u }, {           3937106583u },
	{ 18446744069772445033u }, {           1716372869u },
	{           3092387225u }, {           2980584729u },
	{ 18446744070728966887u }, {           3092387225u },
	{             79056303u }, {           4294239650u },
	{ 18446744069415311966u }, {             79056303u },
	{           4294239650u }, {             79056303u },
	{ 18446744073630495313u }, {           4294239650u },
	{           2980584729u }, {           3092387225u },
	{ 18446744070617164391u }, {           2980584729u },
	{           3937106583u }, {           1716372869u },
	{ 18446744071993178747u }, {           3937106583u },
	{           1570295869u }, {           3997613658u },
	{ 18446744069711937958u }, {           1570295869u },
	{           4196303920u }, {            915301854u },
	{ 18446744072794249762u }, {           4196303920u },
	{           2320018810u }, {           3614451106u },
	{ 18446744070095100510u }, {           2320018810u },
	{           3526608449u }, {           2451484637u },
	{ 18446744071258066979u }, {           3526608449u },
	{            760227338u }, {           4227150159u },
	{ 18446744069482401457u }, {            760227338u },
	{           4265812840u }, {            499584716u },
	{ 18446744073209966900u }, {           4265812840u },
	{           2663125446u }, {           3369644927u },
	{ 18446744070339906689u }, {           2663125446u },
	{           3749914379u }, {           2094011993u },
	{ 18446744071615539623u }, {           3749914379u },
	{           1170899806u }, {           4132279966u },
	{ 18446744069577271650u }, {           1170899806u },
	{           4086382299u }, {           1322204136u },
	{ 18446744072387347480u }, {           4086382299u },
	{           1954569124u }, {           3824448145u },
	{ 18446744069885103471u }, {           1954569124u },
	{           3269339351u }, {           2785348143u },
	{ 18446744070924203473u }, {           3269339351u },
	{            342233465u }, {           4281310585u },
	{ 18446744069428241031u }, {            342233465u },
	{           4285187942u }, {            289669429u },
	{ 18446744073419882187u }, {           4285187942u },
	{           2825258235u }, {           3234912670u },
	{ 18446744070474638946u }, {           2825258235u },
	{           3848145741u }, {           1907490086u },
	{ 18446744071802061530u }, {           3848145741u },
	{           1372250773u }, {           4069849124u },
	{ 18446744069639702492u }, {           1372250773u },
	{           4146337555u }, {           1120102207u },
	{ 18446744072589449409u }, {           4146337555u },
	{           2139871536u }, {           3723935269u },
	{ 18446744069985616347u }, {           2139871536u },
	{           3402071844u }, {           2621574191u },
	{ 18446744071087977425u }, {           3402071844u },
	{            551895183u }, {           4259360959u },
	{ 18446744069450190657u }, {            551895183u },
	{           4236161021u }, {            708296459u },
	{ 18446744073001255157u }, {           4236161021u },
	{           2494576955u }, {           3496259414u },
	{ 18446744070213292202u }, {           2494576955u },
	{           3642649144u }, {           2275489241u },
	{ 18446744071434062375u }, {           3642649144u },
	{            966728038u }, {           4184755784u },
	{ 18446744069524795832u }, {            966728038u },
	{           4016582591u }, {           1521120759u },
	{ 18446744072188430857u }, {           4016582591u },
	{           1764557983u }, {           3915747591u },
	{ 18446744069793804025u }, {           1764557983u },
	{           3128730733u }, {           2942411948u },
	{ 18446744070767139668u }, {           3128730733u },
	{            131747276u }, {           4292946160u },
	{ 18446744069416605456u }, {            131747276u },
	{           4291006167u }, {            184418409u },
	{ 18446744073525133207u }, {           4291006167u },
	{           2903796051u }, {           3164603066u },
	{ 18446744070544948550u }, {           2903796051u },
	{           3893798902u }, {           1812477362u },
	{ 18446744071897074254u }, {           3893798902u },
	{           1471716574u }, {           4034946641u },
	{ 18446744069674604975u }, {           1471716574u },
	{           4172577440u }, {           1018008636u },
	{ 18446744072691542980u }, {           4172577440u },
	{           2230616993u }, {           3670298613u },
	{ 18446744070039253003u }, {           2230616993u },
	{           3465383855u }, {           2537293599u },
	{ 18446744071172258017u }, {           3465383855u },
	{            656258914u }, {           4244533933u },
	{ 18446744069465017683u }, {            656258914u },
	{           4252267634u }, {            604122538u },
	{ 18446744073105429078u }, {           4252267634u },
	{           2579628136u }, {           3433986423u },
	{ 18446744070275565193u }, {           2579628136u },
	{           3697395348u }, {           2185408821u },
	{ 18446744071524142795u }, {           3697395348u },
	{           1069135926u }, {           4159770720u },
	{ 18446744069549780896u }, {           1069135926u },
	{           4052703044u }, {           1422090755u },
	{ 18446744072287460861u }, {           4052703044u },
	{           1860123788u }, {           3871263820u },
	{ 18446744069838287796u }, {           1860123788u },
	{           3199998822u }, {           2864742853u },
	{ 18446744070844808763u }, {           3199998822u },
	{            237061769u }, {           4288419964u },
	{ 18446744069421131652u }, {            237061769u },
	{           4276788480u }, {            394745962u },
	{ 18446744073314805654u }, {           4276788480u },
	{           2745018589u }, {           3303273682u },
	{ 18446744070406277934u }, {           2745018589u },
	{           3800174601u }, {           2001353810u },
	{ 18446744071708197806u }, {           3800174601u },
	{           1271958380u }, {           4102300081u },
	{ 18446744069607251535u }, {           1271958380u },
	{           4117600071u }, {           1221521071u },
	{ 18446744072488030545u }, {           4117600071u },
	{           2047837100u }, {           3775328765u },
	{ 18446744069934222851u }, {           2047837100u },
	{           3336710553u }, {           2704275644u },
	{ 18446744071005275972u }, {           3336710553u },
	{            447199012u }, {           4271622305u },
	{ 18446744069437929311u }, {            447199012u },
	{           4217502704u }, {            812043729u },
	{ 18446744072897507887u }, {           4217502704u },
	{           2408023134u }, {           3556426389u },
	{ 18446744070153125227u }, {           2408023134u },
	{           3585708745u }, {           2364198992u },
	{ 18446744071345352624u }, {           3585708745u },
	{            863737830u }, {           4207220108u },
	{ 18446744069502331508u }, {            863737830u },
	{           3978042699u }, {           1619234497u },
	{ 18446744072090317119u }, {           3978042699u },
	{           1667929275u }, {           3957872662u },
	{ 18446744069751678954u }, {           1667929275u },
	{           3055578014u }, {           3018308645u },
	{ 18446744070691242971u }, {           3055578014u },
	{             26353424u }, {           4294886444u },
	{ 18446744069414665172u }, {             26353424u },
	{           4294947083u }, {             13176774u },
	{ 18446744073696374842u }, {           4294947083u },
	{           3027668821u }, {           3046303593u },
	{ 18446744070663248023u }, {           3027668821u },
	{           3962971170u }, {           1655778843u },
	{ 18446744072053772773u }, {           3962971170u },
	{           1631431340u }, {           3973056236u },
	{ 18446744069736495380u }, {           1631431340u },
	{           4209850218u }, {            850826195u },
	{ 18446744072858725421u }, {           4209850218u },
	{           2375188665u }, {           3578438609u },
	{ 18446744070131113007u }, {           2375188665u },
	{           3563797363u }, {           2397100839u },
	{ 18446744071312450777u }, {           3563797363u },
	{            824979024u }, {           4214991540u },
	{ 18446744069494560076u }, {            824979024u },
	{           4272974189u }, {            434091755u },
	{ 18446744073275459861u }, {           4272974189u },
	{           2714499801u }, {           3328398249u },
	{ 18446744070381153367u }, {           2714499801u },
	{           3781593674u }, {           2036244917u },
	{ 18446744071673306699u }, {           3781593674u },
	{           1234147941u }, {           4113833119u },
	{ 18446744069595718497u }, {           1234147941u },
	{           4106183088u }, {           1259366714u },
	{ 18446744072450184902u }, {           4106183088u },
	{           2013003163u }, {           3794016650u },
	{ 18446744069915534966u }, {           2013003163u },
	{           3311679735u }, {           2734871369u },
	{ 18446744070974680247u }, {           3311679735u },
	{            407865107u }, {           4275557289u },
	{ 18446744069433994327u }, {            407865107u },
	{           4289127078u }, {            223903967u },
	{ 18446744073485647649u }, {           4289127078u },
	{           2874546829u }, {           3191194855u },
	{ 18446744070518356761u }, {           2874546829u },
	{           3876952381u }, {           1848238164u },
	{ 18446744071861313452u }, {           3876952381u },
	{           1434517580u }, {           4048321058u },
	{ 18446744069661230558u }, {           1434517580u },
	{           4163031206u }, {           1056368897u },
	{ 18446744072653182719u }, {           4163031206u },
	{           2196741986u }, {           3690673207u },
	{ 18446744070018878409u }, {           2196741986u },
	{           3441884449u }, {           2569080674u },
	{ 18446744071140470942u }, {           3441884449u },
	{            617165468u }, {           4250394200u },
	{ 18446744069459157416u }, {            617165468u },
	{           4246527332u }, {            643233779u },
	{ 18446744073066317837u }, {           4246527332u },
	{           2547913306u }, {           3457583240u },
	{ 18446744070251968376u }, {           2547913306u },
	{           3677124776u }, {           2219346178u },
	{ 18446744071490205438u }, {           3677124776u },
	{           1030805132u }, {           4169434596u },
	{ 18446744069540117020u }, {           1030805132u },
	{           4039442815u }, {           1459330606u },
	{ 18446744072250221010u }, {           4039442815u },
	{           1824414839u }, {           3888219974u },
	{ 18446744069821331642u }, {           1824414839u },
	{           3173496894u }, {           2894073520u },
	{ 18446744070815478096u }, {           3173496894u },
	{            197582163u }, {           4290420185u },
	{ 18446744069419131431u }, {            197582163u },
	{           4293330151u }, {            118576083u },
	{ 18446744073590975533u }, {           4293330151u },
	{           2951996911u }, {           3119688816u },
	{ 18446744070589862800u }, {           2951996911u },
	{           3921142750u }, {           1752536335u },
	{ 18446744071957015281u }, {           3921142750u },
	{           1533436302u }, {           4011896955u },
	{ 18446744069697654661u }, {           1533436302u },
	{           4187701970u }, {            953884839u },
	{ 18446744072755666777u }, {           4187701970u },
	{           2286654023u }, {           3635650898u },
	{ 18446744070073900718u }, {           2286654023u },
	{           3503896214u }, {           2483838842u },
	{ 18446744071225712774u }, {           3503896214u },
	{            721289485u }, {           4233968062u },
	{ 18446744069475583554u }, {            721289485u },
	{           4261034104u }, {            538825051u },
	{ 18446744073170726565u }, {           4261034104u },
	{           2631999263u }, {           3394012957u },
	{ 18446744070315538659u }, {           2631999263u },
	{           3730482776u }, {           2128436593u },
	{ 18446744071581115023u }, {           3730482776u },
	{           1132817720u }, {           4142881616u },
	{ 18446744069566670000u }, {           1132817720u },
	{           4074039976u }, {           1359758194u },
	{ 18446744072349793422u }, {           4074039976u },
	{           1919287054u }, {           3842275534u },
	{ 18446744069867276082u }, {           1919287054u },
	{           3243565216u }, {           2815320366u },
	{ 18446744070894231250u }, {           3243565216u },
	{            302814837u }, {           4284279082u },
	{ 18446744069425272534u }, {            302814837u },
	{           4282340394u }, {            329096979u },
	{ 18446744073380454637u }, {           4282340394u },
	{           2795365227u }, {           3260778637u },
	{ 18446744070448772979u }, {           2795365227u },
	{           3830426680u }, {           1942826684u },
	{ 18446744071766724932u }, {           3830426680u },
	{           1334734758u }, {           4082306603u },
	{ 18446744069627245013u }, {           1334734758u },
	{           4135852789u }, {           1158216639u },
	{ 18446744072551334977u }, {           4135852789u },
	{           2105506713u }, {           3743472393u },
	{ 18446744069966079223u }, {           2105506713u },
	{           3377799422u }, {           2652774988u },
	{ 18446744071056776628u }, {           3377799422u },
	{            512669694u }, {           4264260060u },
	{ 18446744069445291556u }, {            512669694u },
	{           4229462610u }, {            747255046u },
	{ 18446744072962296570u }, {           4229462610u },
	{           2462292582u }, {           3519070803u },
	{ 18446744070190480813u }, {           2462292582u },
	{           3621551813u }, {           2308918911u },
	{ 18446744071400632705u }, {           3621551813u },
	{            928171626u }, {           4193476065u },
	{ 18446744069516075551u }, {            928171626u },
	{           4002412444u }, {           1558023973u },
	{ 18446744072151527643u }, {           4002412444u },
	{           1728443664u }, {           3931822297u },
	{ 18446744069777729319u }, {           1728443664u },
	{           3101516976u }, {           2971083391u },
	{ 18446744070738468225u }, {           3101516976u },
	{             92230472u }, {           4293976900u },
	{ 18446744069415574716u }, {             92230472u },
	{           4294461982u }, {             65881389u },
	{ 18446744073643670227u }, {           4294461982u },
	{           2990058012u }, {           3083228366u },
	{ 18446744070626323250u }, {           2990058012u },
	{           3942353812u }, {           1704285919u },
	{ 18446744072005265697u }, {           3942353812u },
	{           1582552984u }, {           3992777245u },
	{ 18446744069716774371u }, {           1582552984u },
	{           4199092278u }, {            902423468u },
	{ 18446744072807128148u }, {           4199092278u },
	{           2331096871u }, {           3607316378u },
	{ 18446744070102235238u }, {           2331096871u },
	{           3534112901u }, {           2440653617u },
	{ 18446744071268897999u }, {           3534112901u },
	{            773192474u }, {           4224797921u },
	{ 18446744069484753695u }, {            773192474u },
	{           4267325469u }, {            486495035u },
	{ 18446744073223056581u }, {           4267325469u },
	{           2673450838u }, {           3361458715u },
	{ 18446744070348092901u }, {           2673450838u },
	{           3756321069u }, {           2082497563u },
	{ 18446744071627054053u }, {           3756321069u },
	{           1183571952u }, {           4128668249u },
	{ 18446744069580883367u }, {           1183571952u },
	{           4090419533u }, {           1309661069u },
	{ 18446744072399890547u }, {           4090419533u },
	{           1966293167u }, {           3818433613u },
	{ 18446744069891118003u }, {           1966293167u },
	{           3277869293u }, {           2775304843u },
	{ 18446744070934246773u }, {           3277869293u },
	{            355366730u }, {           4280240479u },
	{ 18446744069429311137u }, {            355366730u },
	{           4286056468u }, {            276521294u },
	{ 18446744073433030322u }, {           4286056468u },
	{           2835169511u }, {           3226229675u },
	{ 18446744070483321941u }, {           2835169511u },
	{           3853979728u }, {           1895675165u },
	{ 18446744071813876451u }, {           3853979728u },
	{           1384730436u }, {           4065619964u },
	{ 18446744069643931652u }, {           1384730436u },
	{           4149754467u }, {           1107376152u },
	{ 18446744072602175464u }, {           4149754467u },
	{           2151286337u }, {           3717352710u },
	{ 18446744069992198906u }, {           2151286337u },
	{           3410098710u }, {           2611124444u },
	{ 18446744071098427172u }, {           3410098710u },
	{            564960121u }, {           4257647723u },
	{ 18446744069451903893u }, {            564960121u },
	{           4238314108u }, {            695296767u },
	{ 18446744073014254849u }, {           4238314108u },
	{           2505291588u }, {           3488589706u },
	{ 18446744070220961910u }, {           2505291588u },
	{           3649613104u }, {           2264303042u },
	{ 18446744071445248574u }, {           3649613104u },
	{            979562138u }, {           4181770210u },
	{ 18446744069527781406u }, {            979562138u },
	{           4021230421u }, {           1508790899u },
	{ 18446744072200760717u }, {           4021230421u },
	{           1776563023u }, {           3910315575u },
	{ 18446744069799236041u }, {           1776563023u },
	{           3137743202u }, {           2932799290u },
	{ 18446744070776752326u }, {           3137743202u },
	{            144917230u }, {           4292521761u },
	{ 18446744069417029855u }, {            144917230u },
	{           4291551760u }, {            171252920u },
	{ 18446744073538298696u }, {           4291551760u },
	{           2913491250u }, {           3155679453u },
	{ 18446744070553872163u }, {           2913491250u },
	{           3899341179u }, {           1800522825u },
	{ 18446744071909028791u }, {           3899341179u },
	{           1484088690u }, {           4030412489u },
	{ 18446744069679139127u }, {           1484088690u },
	{           4175681009u }, {           1005202558u },
	{ 18446744072704349058u }, {           4175681009u },
	{           2241866812u }, {           3663437903u },
	{ 18446744070046113713u }, {           2241866812u },
	{           3473151854u }, {           2526650010u },
	{ 18446744071182901606u }, {           3473151854u },
	{            669277872u }, {           4242500584u },
	{ 18446744069467051032u }, {            669277872u },
	{           4254101044u }, {            591073921u },
	{ 18446744073118477695u }, {           4254101044u },
	{           2590151318u }, {           3426056074u },
	{ 18446744070283495542u }, {           2590151318u },
	{           3704082687u }, {           2174055087u },
	{ 18446744071535496529u }, {           3704082687u },
	{           1081892891u }, {           4156471081u },
	{ 18446744069553080535u }, {           1081892891u },
	{           4057046884u }, {           1409650544u },
	{ 18446744072299901072u }, {           4057046884u },
	{           1871991904u }, {           3865538822u },
	{ 18446744069844012794u }, {           1871991904u },
	{           3208772670u }, {           2854911913u },
	{ 18446744070854639703u }, {           3208772670u },
	{            250217341u }, {           4287672487u },
	{ 18446744069421879129u }, {            250217341u },
	{           4277979416u }, {            381623102u },
	{ 18446744073327928514u }, {           4277979416u },
	{           2755139971u }, {           3294836538u },
	{ 18446744070414715078u }, {           2755139971u },
	{           3806296784u }, {           1989685620u },
	{ 18446744071719865996u }, {           3806296784u },
	{           1284538073u }, {           4098378461u },
	{ 18446744069611173155u }, {           1284538073u },
	{           4121328267u }, {           1208882703u },
	{ 18446744072500668913u }, {           4121328267u },
	{           2059410008u }, {           3769028322u },
	{ 18446744069940523294u }, {           2059410008u },
	{           3344991450u }, {           2694026034u },
	{ 18446744071015525582u }, {           3344991450u },
	{            460302060u }, {           4270230215u },
	{ 18446744069439321401u }, {            460302060u },
	{           4219974170u }, {            799100792u },
	{ 18446744072910450824u }, {           4219974170u },
	{           2418922764u }, {           3549021941u },
	{ 18446744070160529675u }, {           2418922764u },
	{           3592945130u }, {           2353187066u },
	{ 18446744071356364550u }, {           3592945130u },
	{            876641334u }, {           4204550397u },
	{ 18446744069505001219u }, {            876641334u },
	{           3982991719u }, {           1607022414u },
	{ 18446744072102529202u }, {           3982991719u },
	{           1680064008u }, {           3952736900u },
	{ 18446744069756814716u }, {           1680064008u },
	{           3064823674u }, {           3008920059u },
	{ 18446744070700631557u }, {           3064823674u },
	{             39529826u }, {           4294785381u },
	{ 18446744069414766235u }, {             39529826u },
	{           4294785381u }, {             39529826u },
	{ 18446744073670021790u }, {           4294785381u },
	{           3008920059u }, {           3064823674u },
	{ 18446744070644727942u }, {           3008920059u },
	{           3952736900u }, {           1680064008u },
	{ 18446744072029487608u }, {           3952736900u },
	{           1607022414u }, {           3982991719u },
	{ 18446744069726559897u }, {           1607022414u },
	{           4204550397u }, {            876641334u },
	{ 18446744072832910282u }, {           4204550397u },
	{           2353187066u }, {           3592945130u },
	{ 18446744070116606486u }, {           2353187066u },
	{           3549021941u }, {           2418922764u },
	{ 18446744071290628852u }, {           3549021941u },
	{            799100792u }, {           4219974170u },
	{ 18446744069489577446u }, {            799100792u },
	{           4270230215u }, {            460302060u },
	{ 18446744073249249556u }, {           4270230215u },
	{           2694026034u }, {           3344991450u },
	{ 18446744070364560166u }, {           2694026034u },
	{           3769028322u }, {           2059410008u },
	{ 18446744071650141608u }, {           3769028322u },
	{           1208882703u }, {           4121328267u },
	{ 18446744069588223349u }, {           1208882703u },
	{           4098378461u }, {           1284538073u },
	{ 18446744072425013543u }, {           4098378461u },
	{           1989685620u }, {           3806296784u },
	{ 18446744069903254832u }, {           1989685620u },
	{           3294836538u }, {           2755139971u },
	{ 18446744070954411645u }, {           3294836538u },
	{            381623102u }, {           4277979416u },
	{ 18446744069431572200u }, {            381623102u },
	{           4287672487u }, {            250217341u },
	{ 18446744073459334275u }, {           4287672487u },
	{           2854911913u }, {           3208772670u },
	{ 18446744070500778946u }, {           2854911913u },
	{           3865538822u }, {           1871991904u },
	{ 18446744071837559712u }, {           3865538822u },
	{           1409650544u }, {           4057046884u },
	{ 18446744069652504732u }, {           1409650544u },
	{           4156471081u }, {           1081892891u },
	{ 18446744072627658725u }, {           4156471081u },
	{           2174055087u }, {           3704082687u },
	{ 18446744070005468929u }, {           2174055087u },
	{           3426056074u }, {           2590151318u },
	{ 18446744071119400298u }, {           3426056074u },
	{            591073921u }, {           4254101044u },
	{ 18446744069455450572u }, {            591073921u },
	{           4242500584u }, {            669277872u },
	{ 18446744073040273744u }, {           4242500584u },
	{           2526650010u }, {           3473151854u },
	{ 18446744070236399762u }, {           2526650010u },
	{           3663437903u }, {           2241866812u },
	{ 18446744071467684804u }, {           3663437903u },
	{           1005202558u }, {           4175681009u },
	{ 18446744069533870607u }, {           1005202558u },
	{           4030412489u }, {           1484088690u },
	{ 18446744072225462926u }, {           4030412489u },
	{           1800522825u }, {           3899341179u },
	{ 18446744069810210437u }, {           1800522825u },
	{           3155679453u }, {           2913491250u },
	{ 18446744070796060366u }, {           3155679453u },
	{            171252920u }, {           4291551760u },
	{ 18446744069417999856u }, {            171252920u },
	{           4292521761u }, {            144917230u },
	{ 18446744073564634386u }, {           4292521761u },
	{           2932799290u }, {           3137743202u },
	{ 18446744070571808414u }, {           2932799290u },
	{           3910315575u }, {           1776563023u },
	{ 18446744071932988593u }, {           3910315575u },
	{           1508790899u }, {           4021230421u },
	{ 18446744069688321195u }, {           1508790899u },
	{           4181770210u }, {            979562138u },
	{ 18446744072729989478u }, {           4181770210u },
	{           2264303042u }, {           3649613104u },
	{ 18446744070059938512u }, {           2264303042u },
	{           3488589706u }, {           2505291588u },
	{ 18446744071204260028u }, {           3488589706u },
	{            695296767u }, {           4238314108u },
	{ 18446744069471237508u }, {            695296767u },
	{           4257647723u }, {            564960121u },
	{ 18446744073144591495u }, {           4257647723u },
	{           2611124444u }, {           3410098710u },
	{ 18446744070299452906u }, {           2611124444u },
	{           3717352710u }, {           2151286337u },
	{ 18446744071558265279u }, {           3717352710u },
	{           1107376152u }, {           4149754467u },
	{ 18446744069559797149u }, {           1107376152u },
	{           4065619964u }, {           1384730436u },
	{ 18446744072324821180u }, {           4065619964u },
	{           1895675165u }, {           3853979728u },
	{ 18446744069855571888u }, {           1895675165u },
	{           3226229675u }, {           2835169511u },
	{ 18446744070874382105u }, {           3226229675u },
	{            276521294u }, {           4286056468u },
	{ 18446744069423495148u }, {            276521294u },
	{           4280240479u }, {            355366730u },
	{ 18446744073354184886u }, {           4280240479u },
	{           2775304843u }, {           3277869293u },
	{ 18446744070431682323u }, {           2775304843u },
	{           3818433613u }, {           1966293167u },
	{ 18446744071743258449u }, {           3818433613u },
	{           1309661069u }, {           4090419533u },
	{ 18446744069619132083u }, {           1309661069u },
	{           4128668249u }, {           1183571952u },
	{ 18446744072525979664u }, {           4128668249u },
	{           2082497563u }, {           3756321069u },
	{ 18446744069953230547u }, {           2082497563u },
	{           3361458715u }, {           2673450838u },
	{ 18446744071036100778u }, {           3361458715u },
	{            486495035u }, {           4267325469u },
	{ 18446744069442226147u }, {            486495035u },
	{           4224797921u }, {            773192474u },
	{ 18446744072936359142u }, {           4224797921u },
	{           2440653617u }, {           3534112901u },
	{ 18446744070175438715u }, {           2440653617u },
	{           3607316378u }, {           2331096871u },
	{ 18446744071378454745u }, {           3607316378u },
	{            902423468u }, {           4199092278u },
	{ 18446744069510459338u }, {            902423468u },
	{           3992777245u }, {           1582552984u },
	{ 18446744072126998632u }, {           3992777245u },
	{           1704285919u }, {           3942353812u },
	{ 18446744069767197804u }, {           1704285919u },
	{           3083228366u }, {           2990058012u },
	{ 18446744070719493604u }, {           3083228366u },
	{             65881389u }, {           4294461982u },
	{ 18446744069415089634u }, {             65881389u },
	{           4293976900u }, {             92230472u },
	{ 18446744073617321144u }, {           4293976900u },
	{           2971083391u }, {           3101516976u },
	{ 18446744070608034640u }, {           2971083391u },
	{           3931822297u }, {           1728443664u },
	{ 18446744071981107952u }, {           3931822297u },
	{           1558023973u }, {           4002412444u },
	{ 18446744069707139172u }, {           1558023973u },
	{           4193476065u }, {            928171626u },
	{ 18446744072781379990u }, {           4193476065u },
	{           2308918911u }, {           3621551813u },
	{ 18446744070087999803u }, {           2308918911u },
	{           3519070803u }, {           2462292582u },
	{ 18446744071247259034u }, {           3519070803u },
	{            747255046u }, {           4229462610u },
	{ 18446744069480089006u }, {            747255046u },
	{           4264260060u }, {            512669694u },
	{ 18446744073196881922u }, {           4264260060u },
	{           2652774988u }, {           3377799422u },
	{ 18446744070331752194u }, {           2652774988u },
	{           3743472393u }, {           2105506713u },
	{ 18446744071604044903u }, {           3743472393u },
	{           1158216639u }, {           4135852789u },
	{ 18446744069573698827u }, {           1158216639u },
	{           4082306603u }, {           1334734758u },
	{ 18446744072374816858u }, {           4082306603u },
	{           1942826684u }, {           3830426680u },
	{ 18446744069879124936u }, {           1942826684u },
	{           3260778637u }, {           2795365227u },
	{ 18446744070914186389u }, {           3260778637u },
	{            329096979u }, {           4282340394u },
	{ 18446744069427211222u }, {            329096979u },
	{           4284279082u }, {            302814837u },
	{ 18446744073406736779u }, {           4284279082u },
	{           2815320366u }, {           3243565216u },
	{ 18446744070465986400u }, {           2815320366u },
	{           3842275534u }, {           1919287054u },
	{ 18446744071790264562u }, {           3842275534u },
	{           1359758194u }, {           4074039976u },
	{ 18446744069635511640u }, {           1359758194u },
	{           4142881616u }, {           1132817720u },
	{ 18446744072576733896u }, {           4142881616u },
	{           2128436593u }, {           3730482776u },
	{ 18446744069979068840u }, {           2128436593u },
	{           3394012957u }, {           2631999263u },
	{ 18446744071077552353u }, {           3394012957u },
	{            538825051u }, {           4261034104u },
	{ 18446744069448517512u }, {            538825051u },
	{           4233968062u }, {            721289485u },
	{ 18446744072988262131u }, {           4233968062u },
	{           2483838842u }, {           3503896214u },
	{ 18446744070205655402u }, {           2483838842u },
	{           3635650898u }, {           2286654023u },
	{ 18446744071422897593u }, {           3635650898u },
	{            953884839u }, {           4187701970u },
	{ 18446744069521849646u }, {            953884839u },
	{           4011896955u }, {           1533436302u },
	{ 18446744072176115314u }, {           4011896955u },
	{           1752536335u }, {           3921142750u },
	{ 18446744069788408866u }, {           1752536335u },
	{           3119688816u }, {           2951996911u },
	{ 18446744070757554705u }, {           3119688816u },
	{            118576083u }, {           4293330151u },
	{ 18446744069416221465u }, {            118576083u },
	{           4290420185u }, {            197582163u },
	{ 18446744073511969453u }, {           4290420185u },
	{           2894073520u }, {           3173496894u },
	{ 18446744070536054722u }, {           2894073520u },
	{           3888219974u }, {           1824414839u },
	{ 18446744071885136777u }, {           3888219974u },
	{           1459330606u }, {           4039442815u },
	{ 18446744069670108801u }, {           1459330606u },
	{           4169434596u }, {           1030805132u },
	{ 18446744072678746484u }, {           4169434596u },
	{           2219346178u }, {           3677124776u },
	{ 18446744070032426840u }, {           2219346178u },
	{           3457583240u }, {           2547913306u },
	{ 18446744071161638310u }, {           3457583240u },
	{            643233779u }, {           4246527332u },
	{ 18446744069463024284u }, {            643233779u },
	{           4250394200u }, {            617165468u },
	{ 18446744073092386148u }, {           4250394200u },
	{           2569080674u }, {           3441884449u },
	{ 18446744070267667167u }, {           2569080674u },
	{           3690673207u }, {           2196741986u },
	{ 18446744071512809630u }, {           3690673207u },
	{           1056368897u }, {           4163031206u },
	{ 18446744069546520410u }, {           1056368897u },
	{           4048321058u }, {           1434517580u },
	{ 18446744072275034036u }, {           4048321058u },
	{           1848238164u }, {           3876952381u },
	{ 18446744069832599235u }, {           1848238164u },
	{           3191194855u }, {           2874546829u },
	{ 18446744070835004787u }, {           3191194855u },
	{            223903967u }, {           4289127078u },
	{ 18446744069420424538u }, {            223903967u },
	{           4275557289u }, {            407865107u },
	{ 18446744073301686509u }, {           4275557289u },
	{           2734871369u }, {           3311679735u },
	{ 18446744070397871881u }, {           2734871369u },
	{           3794016650u }, {           2013003163u },
	{ 18446744071696548453u }, {           3794016650u },
	{           1259366714u }, {           4106183088u },
	{ 18446744069603368528u }, {           1259366714u },
	{           4113833119u }, {           1234147941u },
	{ 18446744072475403675u }, {           4113833119u },
	{           2036244917u }, {           3781593674u },
	{ 18446744069927957942u }, {           2036244917u },
	{           3328398249u }, {           2714499801u },
	{ 18446744070995051815u }, {           3328398249u },
	{            434091755u }, {           4272974189u },
	{ 18446744069436577427u }, {            434091755u },
	{           4214991540u }, {            824979024u },
	{ 18446744072884572592u }, {           4214991540u },
	{           2397100839u }, {           3563797363u },
	{ 18446744070145754253u }, {           2397100839u },
	{           3578438609u }, {           2375188665u },
	{ 18446744071334362951u }, {           3578438609u },
	{            850826195u }, {           4209850218u },
	{ 18446744069499701398u }, {            850826195u },
	{           3973056236u }, {           1631431340u },
	{ 18446744072078120276u }, {           3973056236u },
	{           1655778843u }, {           3962971170u },
	{ 18446744069746580446u }, {           1655778843u },
	{           3046303593u }, {           3027668821u },
	{ 18446744070681882795u }, {           3046303593u },
	{             13176774u }, {           4294947083u },
	{ 18446744069414604533u }, {             13176774u },
};

/*
 * Let w = exp(i*pi/N); w is a primitive 2N-th root of 1. We define the
 * values w_j = w^(2j+1) for all j from 0 to N-1: these are the roots
 * of X^N+1 in the field of complex numbers. A crucial property is that
 * w_{N-1-j} = conj(w_j) = 1/w_j for all j.
 *
 * FFT representation of a polynomial f (taken modulo X^N+1) is the
 * set of values f(w_j). Since f is real, conj(f(w_j)) = f(conj(w_j)),
 * thus f(w_{N-1-j}) = conj(f(w_j)). We thus store only half the values,
 * for j = 0 to N/2-1; the other half can be recomputed easily when (if)
 * needed. A consequence is that FFT representation has the same size
 * as normal representation: N/2 complex numbers use N real numbers (each
 * complex number is the combination of a real and an imaginary part).
 *
 * We use a specific ordering which makes computations easier. Let rev()
 * be the bit-reversal function over log(N) bits. For j in 0..N/2-1, we
 * store the real and imaginary parts of f(w_j) in slots:
 *
 *    Re(f(w_j)) -> slot rev(j)/2
 *    Im(f(w_j)) -> slot rev(j)/2+N/2
 *
 * (Note that rev(j) is even for j < N/2.)
 */

/* see inner.h */
void
bat_FFT(fnr *f, unsigned logn)
{
	/*
	 * FFT algorithm in bit-reversal order uses the following
	 * iterative algorithm:
	 *
	 *   t = N
	 *   for m = 1; m < N; m *= 2:
	 *       ht = t/2
	 *       for i1 = 0; i1 < m; i1 ++:
	 *           j1 = i1 * t
	 *           s = GM[m + i1]
	 *           for j = j1; j < (j1 + ht); j ++:
	 *               x = f[j]
	 *               y = s * f[j + ht]
	 *               f[j] = x + y
	 *               f[j + ht] = x - y
	 *       t = ht
	 *
	 * GM[k] contains w^rev(k) for primitive root w = exp(i*pi/N).
	 *
	 * In the description above, f[] is supposed to contain complex
	 * numbers. In our in-memory representation, the real and
	 * imaginary parts of f[k] are in array slots k and k+N/2.
	 *
	 * We only keep the first half of the complex numbers. We can
	 * see that after the first iteration, the first and second halves
	 * of the array of complex numbers have separate lives, so we
	 * simply ignore the second part.
	 */

	unsigned u;
	size_t t, n, hn, m;

	/*
	 * First iteration: compute f[j] + i * f[j+N/2] for all j < N/2
	 * (because GM[1] = w^rev(1) = w^(N/2) = i).
	 * In our chosen representation, this is a no-op: everything is
	 * already where it should be.
	 */

	/*
	 * Subsequent iterations are truncated to use only the first
	 * half of values.
	 */
	n = (size_t)1 << logn;
	hn = n >> 1;
	t = hn;
	for (u = 1, m = 2; u < logn; u ++, m <<= 1) {
		size_t ht, hm, i1, j1;

		ht = t >> 1;
		hm = m >> 1;
		for (i1 = 0, j1 = 0; i1 < hm; i1 ++, j1 += t) {
			size_t j, j2;
			fnr s_re, s_im;

			j2 = j1 + ht;
			s_re = fnr_gm_tab[((m + i1) << 1) + 0];
			s_im = fnr_gm_tab[((m + i1) << 1) + 1];
			for (j = j1; j < j2; j ++) {
				fnr x_re, x_im, y_re, y_im;

				x_re = f[j];
				x_im = f[j + hn];
				y_re = f[j + ht];
				y_im = f[j + ht + hn];
				FNC_MUL(y_re, y_im, y_re, y_im, s_re, s_im);
				FNC_ADD(f[j], f[j + hn],
					x_re, x_im, y_re, y_im);
				FNC_SUB(f[j + ht], f[j + ht + hn],
					x_re, x_im, y_re, y_im);
			}
		}
		t = ht;
	}
}

/* see inner.h */
void
bat_iFFT(fnr *f, unsigned logn)
{
	/*
	 * Inverse FFT algorithm in bit-reversal order uses the following
	 * iterative algorithm:
	 *
	 *   t = 1
	 *   for m = N; m > 1; m /= 2:
	 *       hm = m/2
	 *       dt = t*2
	 *       for i1 = 0; i1 < hm; i1 ++:
	 *           j1 = i1 * dt
	 *           s = iGM[hm + i1]
	 *           for j = j1; j < (j1 + t); j ++:
	 *               x = f[j]
	 *               y = f[j + t]
	 *               f[j] = x + y
	 *               f[j + t] = s * (x - y)
	 *       t = dt
	 *   for i1 = 0; i1 < N; i1 ++:
	 *       f[i1] = f[i1] / N
	 *
	 * iGM[k] contains (1/w)^rev(k) for primitive root w = exp(i*pi/N)
	 * (actually, iGM[k] = 1/GM[k] = conj(GM[k])).
	 *
	 * In the main loop (not counting the final division loop), in
	 * all iterations except the last, the first and second half of f[]
	 * (as an array of complex numbers) are separate. In our chosen
	 * representation, we do not keep the second half.
	 *
	 * The last iteration recombines the recomputed half with the
	 * implicit half, and should yield only real numbers since the
	 * target polynomial is real; moreover, s = i at that step.
	 * Thus, when considering x and y:
	 *    y = conj(x) since the final f[j] must be real
	 *    Therefore, f[j] is filled with 2*Re(x), and f[j + t] is
	 *    filled with 2*Im(x).
	 * But we already have Re(x) and Im(x) in array slots j and j+t
	 * in our chosen representation. That last iteration is thus a
	 * simple doubling of the values in all the array.
	 *
	 * We make the last iteration a no-op by tweaking the final
	 * division into a division by N/2, not N.
	 */
	size_t u, n, hn, t, m;

	n = (size_t)1 << logn;
	t = 1;
	m = n;
	hn = n >> 1;
	for (u = logn; u > 1; u --) {
		size_t hm, dt, i1, j1;

		hm = m >> 1;
		dt = t << 1;
		for (i1 = 0, j1 = 0; j1 < hn; i1 ++, j1 += dt) {
			size_t j, j2;
			fnr s_re, s_im;

			j2 = j1 + t;
			s_re = fnr_gm_tab[((hm + i1) << 1) + 0];
			s_im = fnr_neg(fnr_gm_tab[((hm + i1) << 1) + 1]);
			for (j = j1; j < j2; j ++) {
				fnr x_re, x_im, y_re, y_im;

				x_re = f[j];
				x_im = f[j + hn];
				y_re = f[j + t];
				y_im = f[j + t + hn];
				FNC_ADD(f[j], f[j + hn],
					x_re, x_im, y_re, y_im);
				FNC_SUB(x_re, x_im, x_re, x_im, y_re, y_im);
				FNC_MUL(f[j + t], f[j + t + hn],
					x_re, x_im, s_re, s_im);
			}
		}
		t = dt;
		m = hm;
	}

	/*
	 * Last iteration is a no-op, provided that we divide by N/2
	 * instead of N. We need to make a special case for logn = 0.
	 */
	if (logn > 1) {
		for (u = 0; u < n; u ++) {
			f[u] = fnr_div_2e(f[u], logn - 1);
		}
	}
}

/* see inner.h */
void
bat_poly_add(fnr *restrict a, const fnr *restrict b, unsigned logn)
{
	size_t u, n;

	n = (size_t)1 << logn;
	for (u = 0; u < n; u ++) {
		a[u] = fnr_add(a[u], b[u]);
	}
}

/* see inner.h */
void
bat_poly_sub(fnr *restrict a, const fnr *restrict b, unsigned logn)
{
	size_t u, n;

	n = (size_t)1 << logn;
	for (u = 0; u < n; u ++) {
		a[u] = fnr_sub(a[u], b[u]);
	}
}

/* see inner.h */
void
bat_poly_neg(fnr *a, unsigned logn)
{
	size_t u, n;

	n = (size_t)1 << logn;
	for (u = 0; u < n; u ++) {
		a[u] = fnr_neg(a[u]);
	}
}

/* see inner.h */
void
bat_poly_mulconst(fnr *a, fnr c, unsigned logn)
{
	size_t u, n;

	n = (size_t)1 << logn;
	for (u = 0; u < n; u ++) {
		a[u] = fnr_mul(a[u], c);
	}
}

/* see inner.h */
void
bat_poly_mul_fft(fnr *restrict a, const fnr *restrict b, unsigned logn)
{
	size_t u, hn;

	hn = (size_t)1 << (logn - 1);
	for (u = 0; u < hn; u ++) {
		FNC_MUL(a[u], a[u + hn], a[u], a[u + hn], b[u], b[u + hn]);
	}
}

/* see inner.h */
void
bat_poly_adj_fft(fnr *a, unsigned logn)
{
	size_t u, n;

	n = (size_t)1 << logn;
	for (u = n >> 1; u < n; u ++) {
		a[u] = fnr_neg(a[u]);
	}
}

/* see inner.h */
void
bat_poly_div_2e(fnr *a, unsigned e, unsigned logn)
{
	size_t u, n;

	n = (size_t)1 << logn;
	for (u = 0; u < n; u ++) {
		a[u] = fnr_div_2e(a[u], e);
	}
}

/* see inner.h */
void
bat_poly_mul_autoadj_fft(fnr *restrict a, const fnr *restrict b, unsigned logn)
{
	size_t u, hn;

	hn = (size_t)1 << (logn - 1);
	for (u = 0; u < hn; u ++) {
		a[u] = fnr_mul(a[u], b[u]);
		a[u + hn] = fnr_mul(a[u + hn], b[u]);
	}
}

/* see inner.h */
void
bat_poly_div_autoadj_fft(fnr *restrict a, const fnr *restrict b, unsigned logn)
{
	size_t u, hn;

	hn = (size_t)1 << (logn - 1);
	for (u = 0; u < hn; u ++) {
		a[u] = fnr_div(a[u], b[u]);
		a[u + hn] = fnr_div(a[u + hn], b[u]);
	}
}

/* see inner.h */
void
bat_poly_invnorm_fft(fnr *restrict d,
	const fnr *restrict a, const fnr *restrict b, unsigned e, unsigned logn)
{
	size_t n, hn, u;

	n = (size_t)1 << logn;
	hn = n >> 1;
	for (u = 0; u < hn; u ++) {
		fnr a_re, a_im;
		fnr b_re, b_im;

		a_re = a[u];
		a_im = a[u + hn];
		b_re = b[u];
		b_im = b[u + hn];
		d[u] = fnr_div(
			fnr_of((uint32_t)1 << e),
			fnr_add(
				fnr_add(fnr_sqr(a_re), fnr_sqr(a_im)),
				fnr_add(fnr_sqr(b_re), fnr_sqr(b_im))));
	}
}
